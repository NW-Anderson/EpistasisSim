i <- 0
for(j in 2:nsites){
if(poolfile[j,1] != poolfile[j-1,1]){
i <- i + 1
max.scaffold.position[i,] <- poolfile[j-1,1:2]
}
}
max.scaffold.position[nscaff,] <- poolfile[nsites,1:2]
poolfile <- poolfile[(as.numeric(poolfile[,3]) <= 99.5 & as.numeric(poolfile [,3]) >= .005),]
bedfile <- data.frame(chr = vector(length = nscaff),
start = vector(length = nscaff),
end = vector(length = nscaff))
bedfile[,1] <- max.scaffold.position[,1]
bedfile[,2] <- rep.int(0, times = nscaff)
bedfile[,3] <- round_any(as.integer(max.scaffold.position[,2]), 1000, ceiling)
setwd("/media/nathan/easystore")
library(vcfR)
library(plyr)
vcf <- read.vcfR('MIE.vcf')
# plot(density(extract.gt(vcf, element = 'FREQ', as.numeric = T)))
# plot(density(extract.gt(vcf, element = 'AD', as.numeric = T) / extract.gt(vcf, element = 'DP', as.numeric = T)))
freq <- extract.gt(vcf, element = 'FREQ', as.numeric = T)
nsites <- nrow(freq)
poolfile <- array(dim = c(nsites,3))
# poolfile[,1] <- gsub("_.*", "", rownames(freq2))
# poolfile[,2] <- gsub(".*_", "", rownames(freq2))
# poolfile[,3] <- freq
poolfile[,1] <- paste(gsub(";.*", "", rownames(freq)),
gsub("_.*", "", gsub(".*;", "", rownames(freq))), sep = ';')
poolfile[,2] <- gsub(".*_", "", rownames(freq))
poolfile[,3] <- freq
tmp <- sort(table(poolfile[,1]), decreasing = T)
poolfile <- poolfile[(poolfile[,1] %in% names(tmp)[1:4]),]
nsites <- nrow(poolfile)
nscaff <- length(unique(poolfile[,1]))
max.scaffold.position <- array(dim = c(nscaff, 2))
i <- 0
for(j in 2:nsites){
if(poolfile[j,1] != poolfile[j-1,1]){
i <- i + 1
max.scaffold.position[i,] <- poolfile[j-1,1:2]
}
}
max.scaffold.position[nscaff,] <- poolfile[nsites,1:2]
poolfile <- poolfile[(as.numeric(poolfile[,3]) <= 99.5 & as.numeric(poolfile [,3]) >= .005),]
bedfile <- data.frame(chr = vector(length = nscaff),
start = vector(length = nscaff),
end = vector(length = nscaff))
bedfile[,1] <- max.scaffold.position[,1]
bedfile[,2] <- rep.int(0, times = nscaff)
bedfile[,3] <- round_any(as.integer(max.scaffold.position[,2]), 1000, ceiling)
write.table(bedfile, "MIE.bed", row.names = F, col.names = F, quote = F, sep = '\t')
write.table(poolfile, "MIE.pool", row.names = F, col.names = F, quote = F, sep = '\t')
setwd("/media/nathan/easystore")
library(data.table)
data <- fread(file = "VIE_output/VIE.PREDICT.BSCORRECTED.txt")
windowsizes <- fread(file = "VIE_output/networks/windowSizes.txt")
unique(data$end - data$start)
chrom1 <- data[data$chrom == "Scz6wRH_1685;HRSCAF=1840"]
chrom2 <- data[data$chrom == "Scz6wRH_1693;HRSCAF=1917"]
chrom3 <- data[data$chrom == "Scz6wRH_23;HRSCAF=98"]
chrom4 <- data[data$chrom == "Scz6wRH_2;HRSCAF=24"]
snpdensity <- (chrom1$end - chrom1$start) / chrom1$nSites
summary(snpdensity)
plot(density(snpdensity))
var(snpdensity)
min(chrom1$start)
max(chrom1$end)
y <- rep(chrom1$recombRate, each = 2)
plot(y[1:100], type = 'l')
plot(y[1:500], type = 'l')
plot(y, type = 'l')
plot(y[1:1000], type = 'l')
plot(y[1:500], type = 'l')
plot(y[501:1000], type = 'l')
plot(y[1001:1500], type = 'l')
plot(y[1501:2000], type = 'l')
?pnorm(42.12)
pnorm(42.12)
1-pnorm(42.12)
pnorm(42.12, log = T)
?pt
pt(42.12, 776345 log.p =  = T)
pt(42.12, 776345, log.p =  = T)
pt(42.12, 776345, log.p = T)
pt(42.12, 776345)
pnorm(7.33, log = T)
?? manhattan
setwd("~/")
plot(density(c(-5.66617, -4.04316, -8.37353, 2.36646, -18.0919, -16.8729, -4.82575, -10.3389, -1.98658, -5.73012, 8.86155, -19.5171, -12.0238, -9.6889, 13.117, 4.06623, -2.80454, -10.8397, 4.33737, -6.26259, -15.6942, -8.02427, 0.144362, 5.62668, 10.6957, -4.82202, 5.87922, 2.72121, 10.6724, 9.7351, 16.2918, 9.43877, -9.27698, -8.71053, -9.82637, 9.75014, -17.1566, 5.93795, 1.75586, 9.00507, 4.52858, 2.52487, -4.0097, 4.15912, -2.05357, -12.6709, 0.276251, -13.1831, 19.1606, -7.30719, 8.82338, 3.18727, -19.3031, -3.53587, 5.18039, -2.1716, 2.26269, -18.1886, -4.23604, 2.20461, -3.64057, 6.14764, -20.4844, -2.48482, 1.85714, 2.83248, -1.63155, 1.18404, 4.69635, 11.6412, -0.49095, -3.34561, 18.32, 7.38042, 6.94133, 8.02371, 6.58309, -2.36223, 5.56471, -19.7254, 18.9698, 6.95512, -2.58096, 11.8546, -12.0443, -3.95695, 13.2732, -1.56812, -1.29381, -12.8721, -0.125778, 1.91169, 6.92839, -8.65606, -7.0797, -7.38147, 13.2883, -12.0632, 12.4999, 7.15478, 2.23228, 11.6576, -6.29195, 10.4249, 10.3944, -9.99512, -0.0278962, 16.5471, 13.1591, 10.595, -1.23791, 13.9528, -2.99213, -13.2838, -19.8328, -0.316844, -0.231031, -6.65275, 8.16559, -0.395187, -2.2347, 0.567379, -2.52104, 4.42737, 0.019386, 6.34154, -17.3032, -8.07562, -17.4881, 1.67987, -32.2397, -2.88786, 16.6696, 2.42339, -2.61061, 0.332972, -9.65453, -4.7152, 9.39784, -21.3683, -2.7891, -1.47142, 3.64088, -19.4054, -4.22799, 6.02261, 8.64935, -10.6361, 0.324926, 9.04967, -8.85765, -9.23384, -5.59507, -3.23616, -16.798, -6.36774, -11.5263, 6.35869, -3.11659, -16.2936, -16.1043, -4.95257, -13.1307, -3.01546, 1.56546, -13.0288, 15.5564, -8.48726, -5.51753, 1.34621, 3.50685, -2.60643, -6.6046, 1.21088, -2.21754, -9.33144, -5.89475, -3.75448, -2.87301, -0.785521, 6.64574, 5.95354, 9.3818, 0.136919, -5.86371, 2.70095, -18.8488, -1.44627, 2.56111, 28.7079, 7.35823, -7.99454, 17.9521, 13.0294, -5.91295, -1.7656, 1.61305, 9.34423, -17.9016, 10.5368, 9.10991, 0.407626, 26.7989, -3.74135, 5.0303, 15.6957, 0.267234, 18.4198, -5.73488, -2.39445, -9.7084, 10.6797, 1.23832, 23.5109, -2.6554, 4.64276, -5.31417, -5.14342, -6.64921, 10.0053, 3.99303, 0.257101, -1.19218, 14.9264, -7.23372, -3.69338, 4.10929, -6.23884, 11.8928, -6.62754, -1.29964, 3.78404, -16.2032, -9.05516, 18.5408, 17.9591, -1.31808, 15.3894, -1.96743, 12.1552, 10.1205, -2.35646, -2.964, 11.0719, -6.8081, 0.207617, -3.55323, -11.7092, 5.44046, -10.4181, -3.89491, 3.10656, 3.30114, -23.3613, -9.21074, -7.93881, -0.130789, 5.29897, -10.2003, -2.20318, 3.12199, 5.62244, 6.35004, -2.57322, -20.7089, -10.0574, 0.373423, 2.30288, -4.96459, 5.03268, 6.72165, -2.32482, -13.308, -0.00591522, -5.67469, -7.20664, 10.225, -4.01846, 15.2182, -3.89074, 3.82737, 10.2601, -3.04303, 16.095, 2.93864, -12.2585, -1.00981, -9.26042, -8.57367, 14.7721, 5.74331, 9.66847, -6.38309, -6.55133, -9.86003, -4.12024, -21.1392, 21.8521, -12.8212, -2.88583, 13.2002, -9.40251, -4.99795, 9.27229, 13.6098, 12.2145, 4.30175, -6.35023, 13.9882, -16.5936, -0.943788, 9.67642, -3.97249, -13.1865, -11.1041, 15.8192, 0.0841897, -12.9555, 1.86595, -7.44207, 15.0369, -5.34339, 8.29651, -1.48377, 6.85304, 3.88568, 10.6875, -3.71719, -10.1058, 5.21657, 0.91121, 8.08916, -6.27634, -1.84916, -8.41032, -4.81973, 2.09133, -1.65549, 14.473, 5.43135, 16.7953, 18.4495, 10.448, 10.2405, 2.05461, 1.69844, -28.1261, 12.0208, 0.456494, 16.8489, 3.33814, 12.1927, 3.71899, -5.32856, -6.45676, 6.68535, -7.04938, 2.49077, 6.09165, 15.8323, -2.29636, 8.39113, 10.455, -2.1317, 8.42727, -3.86663, 3.83541, -7.48336, 4.43802, -16.5646, 1.30327, 6.67074, -2.09986, -4.5706, -19.7646, -7.52276, -4.38797, -0.317302, -10.5347, -7.32772, 0.985516, 17.5833, 1.67793, 7.93042, 2.80985, 10.4229, 3.66888, -1.31417, 0.667819, 11.8864, -0.204737, -2.45872, -8.23323, 4.19035, -1.0725, -1.83337, 6.24622, 9.99697, 4.56134, 4.1057, 0.985324, -10.3802, 0.896837, -7.8647, 24.8408, 13.4912, -0.781501, -12.9632, -8.70686, 10.4755, -5.713, -5.71744, 13.3873, -11.3392, -0.261854, -1.46439, -1.801, 2.2396, 4.54412, 12.2183, 14.1771, -7.63861, -0.165078, -10.7337, -8.91264, 1.64392, 2.48099, 14.5376, 7.2159, 11.2742, 2.0162, -18.6678, -10.4734, 6.25276, 2.56863, 6.81633, -8.22421, -0.894961, -9.54764, -3.58953, -2.24902, 3.24052, 2.13827, -2.97264, 12.7571, -4.72481, 1.64881, 6.48525, 17.7058, -11.2629, 2.79035, -5.21706, -6.86172, 12.6638, -4.52133, 12.5149, 1.62079, 4.55371, 0.288851, -21.6445, 2.73154, -8.88006, -23.0672, -4.7953, 1.6765, 1.60166, 14.4732, 0.41955, -4.25002, 10.7512, -11.7658, -3.86514, 19.8116, 2.59178, 17.2492, 2.5176, -24.9206, -6.60869, 3.43874, 7.37036, -11.8929, -5.13794, 8.55787, 4.12453, -12.5432, -4.98376, -2.21745, 1.11497, -26.0134, -11.4617, 11.3238, 7.71555, -17.1011, -1.77521, -8.10137, -17.6965, 7.53612, -2.36685, -12.085, -1.15339)))
plot(density(c(-5.66617, -4.04316, -8.37353, 2.36646, -18.0919, -16.8729, -4.82575, -10.3389, -1.98658, -5.73012, 8.86155, -19.5171, -12.0238, -9.6889, 13.117, 4.06623, -2.80454, -10.8397, 4.33737, -6.26259, -15.6942, -8.02427, 0.144362, 5.62668, 10.6957, -4.82202, 5.87922, 2.72121, 10.6724, 9.7351, 16.2918, 9.43877, -9.27698, -8.71053, -9.82637, 9.75014, -17.1566, 5.93795, 1.75586, 9.00507, 4.52858, 2.52487, -4.0097, 4.15912, -2.05357, -12.6709, 0.276251, -13.1831, 19.1606, -7.30719, 8.82338, 3.18727, -19.3031, -3.53587, 5.18039, -2.1716, 2.26269, -18.1886, -4.23604, 2.20461, -3.64057, 6.14764, -20.4844, -2.48482, 1.85714, 2.83248, -1.63155, 1.18404, 4.69635, 11.6412, -0.49095, -3.34561, 18.32, 7.38042, 6.94133, 8.02371, 6.58309, -2.36223, 5.56471, -19.7254, 18.9698, 6.95512, -2.58096, 11.8546, -12.0443, -3.95695, 13.2732, -1.56812, -1.29381, -12.8721, -0.125778, 1.91169, 6.92839, -8.65606, -7.0797, -7.38147, 13.2883, -12.0632, 12.4999, 7.15478, 2.23228, 11.6576, -6.29195, 10.4249, 10.3944, -9.99512, -0.0278962, 16.5471, 13.1591, 10.595, -1.23791, 13.9528, -2.99213, -13.2838, -19.8328, -0.316844, -0.231031, -6.65275, 8.16559, -0.395187, -2.2347, 0.567379, -2.52104, 4.42737, 0.019386, 6.34154, -17.3032, -8.07562, -17.4881, 1.67987, -32.2397, -2.88786, 16.6696, 2.42339, -2.61061, 0.332972, -9.65453, -4.7152, 9.39784, -21.3683, -2.7891, -1.47142, 3.64088, -19.4054, -4.22799, 6.02261, 8.64935, -10.6361, 0.324926, 9.04967, -8.85765, -9.23384, -5.59507, -3.23616, -16.798, -6.36774, -11.5263, 6.35869, -3.11659, -16.2936, -16.1043, -4.95257, -13.1307, -3.01546, 1.56546, -13.0288, 15.5564, -8.48726, -5.51753, 1.34621, 3.50685, -2.60643, -6.6046, 1.21088, -2.21754, -9.33144, -5.89475, -3.75448, -2.87301, -0.785521, 6.64574, 5.95354, 9.3818, 0.136919, -5.86371, 2.70095, -18.8488, -1.44627, 2.56111, 28.7079, 7.35823, -7.99454, 17.9521, 13.0294, -5.91295, -1.7656, 1.61305, 9.34423, -17.9016, 10.5368, 9.10991, 0.407626, 26.7989, -3.74135, 5.0303, 15.6957, 0.267234, 18.4198, -5.73488, -2.39445, -9.7084, 10.6797, 1.23832, 23.5109, -2.6554, 4.64276, -5.31417, -5.14342, -6.64921, 10.0053, 3.99303, 0.257101, -1.19218, 14.9264, -7.23372, -3.69338, 4.10929, -6.23884, 11.8928, -6.62754, -1.29964, 3.78404, -16.2032, -9.05516, 18.5408, 17.9591, -1.31808, 15.3894, -1.96743, 12.1552, 10.1205, -2.35646, -2.964, 11.0719, -6.8081, 0.207617, -3.55323, -11.7092, 5.44046, -10.4181, -3.89491, 3.10656, 3.30114, -23.3613, -9.21074, -7.93881, -0.130789, 5.29897, -10.2003, -2.20318, 3.12199, 5.62244, 6.35004, -2.57322, -20.7089, -10.0574, 0.373423, 2.30288, -4.96459, 5.03268, 6.72165, -2.32482, -13.308, -0.00591522, -5.67469, -7.20664, 10.225, -4.01846, 15.2182, -3.89074, 3.82737, 10.2601, -3.04303, 16.095, 2.93864, -12.2585, -1.00981, -9.26042, -8.57367, 14.7721, 5.74331, 9.66847, -6.38309, -6.55133, -9.86003, -4.12024, -21.1392, 21.8521, -12.8212, -2.88583, 13.2002, -9.40251, -4.99795, 9.27229, 13.6098, 12.2145, 4.30175, -6.35023, 13.9882, -16.5936, -0.943788, 9.67642, -3.97249, -13.1865, -11.1041, 15.8192, 0.0841897, -12.9555, 1.86595, -7.44207, 15.0369, -5.34339, 8.29651, -1.48377, 6.85304, 3.88568, 10.6875, -3.71719, -10.1058, 5.21657, 0.91121, 8.08916, -6.27634, -1.84916, -8.41032, -4.81973, 2.09133, -1.65549, 14.473, 5.43135, 16.7953, 18.4495, 10.448, 10.2405, 2.05461, 1.69844, -28.1261, 12.0208, 0.456494, 16.8489, 3.33814, 12.1927, 3.71899, -5.32856, -6.45676, 6.68535, -7.04938, 2.49077, 6.09165, 15.8323, -2.29636, 8.39113, 10.455, -2.1317, 8.42727, -3.86663, 3.83541, -7.48336, 4.43802, -16.5646, 1.30327, 6.67074, -2.09986, -4.5706, -19.7646, -7.52276, -4.38797, -0.317302, -10.5347, -7.32772, 0.985516, 17.5833, 1.67793, 7.93042, 2.80985, 10.4229, 3.66888, -1.31417, 0.667819, 11.8864, -0.204737, -2.45872, -8.23323, 4.19035, -1.0725, -1.83337, 6.24622, 9.99697, 4.56134, 4.1057, 0.985324, -10.3802, 0.896837, -7.8647, 24.8408, 13.4912, -0.781501, -12.9632, -8.70686, 10.4755, -5.713, -5.71744, 13.3873, -11.3392, -0.261854, -1.46439, -1.801, 2.2396, 4.54412, 12.2183, 14.1771, -7.63861, -0.165078, -10.7337, -8.91264, 1.64392, 2.48099, 14.5376, 7.2159, 11.2742, 2.0162, -18.6678, -10.4734, 6.25276, 2.56863, 6.81633, -8.22421, -0.894961, -9.54764, -3.58953, -2.24902, 3.24052, 2.13827, -2.97264, 12.7571, -4.72481, 1.64881, 6.48525, 17.7058, -11.2629, 2.79035, -5.21706, -6.86172, 12.6638, -4.52133, 12.5149, 1.62079, 4.55371, 0.288851, -21.6445, 2.73154, -8.88006, -23.0672, -4.7953, 1.6765, 1.60166, 14.4732, 0.41955, -4.25002, 10.7512, -11.7658, -3.86514, 19.8116, 2.59178, 17.2492, 2.5176, -24.9206, -6.60869, 3.43874, 7.37036, -11.8929, -5.13794, 8.55787, 4.12453, -12.5432, -4.98376, -2.21745, 1.11497, -26.0134, -11.4617, 11.3238, 7.71555, -17.1011, -1.77521, -8.10137, -17.6965, 7.53612, -2.36685, -12.085, -1.15339)))
plot(density(c(-5.66617, -4.04316, -8.37353, 2.36646, -18.0919, -16.8729, -4.82575, -10.3389, -1.98658, -5.73012, 8.86155, -19.5171, -12.0238, -9.6889, 13.117, 4.06623, -2.80454, -10.8397, 4.33737, -6.26259, -15.6942, -8.02427, 0.144362, 5.62668, 10.6957, -4.82202, 5.87922, 2.72121, 10.6724, 9.7351, 16.2918, 9.43877, -9.27698, -8.71053, -9.82637, 9.75014, -17.1566, 5.93795, 1.75586, 9.00507, 4.52858, 2.52487, -4.0097, 4.15912, -2.05357, -12.6709, 0.276251, -13.1831, 19.1606, -7.30719, 8.82338, 3.18727, -19.3031, -3.53587, 5.18039, -2.1716, 2.26269, -18.1886, -4.23604, 2.20461, -3.64057, 6.14764, -20.4844, -2.48482, 1.85714, 2.83248, -1.63155, 1.18404, 4.69635, 11.6412, -0.49095, -3.34561, 18.32, 7.38042, 6.94133, 8.02371, 6.58309, -2.36223, 5.56471, -19.7254, 18.9698, 6.95512, -2.58096, 11.8546, -12.0443, -3.95695, 13.2732, -1.56812, -1.29381, -12.8721, -0.125778, 1.91169, 6.92839, -8.65606, -7.0797, -7.38147, 13.2883, -12.0632, 12.4999, 7.15478, 2.23228, 11.6576, -6.29195, 10.4249, 10.3944, -9.99512, -0.0278962, 16.5471, 13.1591, 10.595, -1.23791, 13.9528, -2.99213, -13.2838, -19.8328, -0.316844, -0.231031, -6.65275, 8.16559, -0.395187, -2.2347, 0.567379, -2.52104, 4.42737, 0.019386, 6.34154, -17.3032, -8.07562, -17.4881, 1.67987, -32.2397, -2.88786, 16.6696, 2.42339, -2.61061, 0.332972, -9.65453, -4.7152, 9.39784, -21.3683, -2.7891, -1.47142, 3.64088, -19.4054, -4.22799, 6.02261, 8.64935, -10.6361, 0.324926, 9.04967, -8.85765, -9.23384, -5.59507, -3.23616, -16.798, -6.36774, -11.5263, 6.35869, -3.11659, -16.2936, -16.1043, -4.95257, -13.1307, -3.01546, 1.56546, -13.0288, 15.5564, -8.48726, -5.51753, 1.34621, 3.50685, -2.60643, -6.6046, 1.21088, -2.21754, -9.33144, -5.89475, -3.75448, -2.87301, -0.785521, 6.64574, 5.95354, 9.3818, 0.136919, -5.86371, 2.70095, -18.8488, -1.44627, 2.56111, 28.7079, 7.35823, -7.99454, 17.9521, 13.0294, -5.91295, -1.7656, 1.61305, 9.34423, -17.9016, 10.5368, 9.10991, 0.407626, 26.7989, -3.74135, 5.0303, 15.6957, 0.267234, 18.4198, -5.73488, -2.39445, -9.7084, 10.6797, 1.23832, 23.5109, -2.6554, 4.64276, -5.31417, -5.14342, -6.64921, 10.0053, 3.99303, 0.257101, -1.19218, 14.9264, -7.23372, -3.69338, 4.10929, -6.23884, 11.8928, -6.62754, -1.29964, 3.78404, -16.2032, -9.05516, 18.5408, 17.9591, -1.31808, 15.3894, -1.96743, 12.1552, 10.1205, -2.35646, -2.964, 11.0719, -6.8081, 0.207617, -3.55323, -11.7092, 5.44046, -10.4181, -3.89491, 3.10656, 3.30114, -23.3613, -9.21074, -7.93881, -0.130789, 5.29897, -10.2003, -2.20318, 3.12199, 5.62244, 6.35004, -2.57322, -20.7089, -10.0574, 0.373423, 2.30288, -4.96459, 5.03268, 6.72165, -2.32482, -13.308, -0.00591522, -5.67469, -7.20664, 10.225, -4.01846, 15.2182, -3.89074, 3.82737, 10.2601, -3.04303, 16.095, 2.93864, -12.2585, -1.00981, -9.26042, -8.57367, 14.7721, 5.74331, 9.66847, -6.38309, -6.55133, -9.86003, -4.12024, -21.1392, 21.8521, -12.8212, -2.88583, 13.2002, -9.40251, -4.99795, 9.27229, 13.6098, 12.2145, 4.30175, -6.35023, 13.9882, -16.5936, -0.943788, 9.67642, -3.97249, -13.1865, -11.1041, 15.8192, 0.0841897, -12.9555, 1.86595, -7.44207, 15.0369, -5.34339, 8.29651, -1.48377, 6.85304, 3.88568, 10.6875, -3.71719, -10.1058, 5.21657, 0.91121, 8.08916, -6.27634, -1.84916, -8.41032, -4.81973, 2.09133, -1.65549, 14.473, 5.43135, 16.7953, 18.4495, 10.448, 10.2405, 2.05461, 1.69844, -28.1261, 12.0208, 0.456494, 16.8489, 3.33814, 12.1927, 3.71899, -5.32856, -6.45676, 6.68535, -7.04938, 2.49077, 6.09165, 15.8323, -2.29636, 8.39113, 10.455, -2.1317, 8.42727, -3.86663, 3.83541, -7.48336, 4.43802, -16.5646, 1.30327, 6.67074, -2.09986, -4.5706, -19.7646, -7.52276, -4.38797, -0.317302, -10.5347, -7.32772, 0.985516, 17.5833, 1.67793, 7.93042, 2.80985, 10.4229, 3.66888, -1.31417, 0.667819, 11.8864, -0.204737, -2.45872, -8.23323, 4.19035, -1.0725, -1.83337, 6.24622, 9.99697, 4.56134, 4.1057, 0.985324, -10.3802, 0.896837, -7.8647, 24.8408, 13.4912, -0.781501, -12.9632, -8.70686, 10.4755, -5.713, -5.71744, 13.3873, -11.3392, -0.261854, -1.46439, -1.801, 2.2396, 4.54412, 12.2183, 14.1771, -7.63861, -0.165078, -10.7337, -8.91264, 1.64392, 2.48099, 14.5376, 7.2159, 11.2742, 2.0162, -18.6678, -10.4734, 6.25276, 2.56863, 6.81633, -8.22421, -0.894961, -9.54764, -3.58953, -2.24902, 3.24052, 2.13827, -2.97264, 12.7571, -4.72481, 1.64881, 6.48525, 17.7058, -11.2629, 2.79035, -5.21706, -6.86172, 12.6638, -4.52133, 12.5149, 1.62079, 4.55371, 0.288851, -21.6445, 2.73154, -8.88006, -23.0672, -4.7953, 1.6765, 1.60166, 14.4732, 0.41955, -4.25002, 10.7512, -11.7658, -3.86514, 19.8116, 2.59178, 17.2492, 2.5176, -24.9206, -6.60869, 3.43874, 7.37036, -11.8929, -5.13794, 8.55787, 4.12453, -12.5432, -4.98376, -2.21745, 1.11497, -26.0134, -11.4617, 11.3238, 7.71555, -17.1011, -1.77521, -8.10137, -17.6965, 7.53612, -2.36685, -12.085, -1.15339)))
)
)
plot(density(-5.66617, -4.04316, -8.37353, 2.36646, -18.0919, -16.8729, -4.82575, -10.3389, -1.98658, -5.73012, 8.86155, -19.5171, -12.0238, -9.6889, 13.117, 4.06623, -2.80454, -10.8397, 4.33737, -6.26259, -15.6942, -8.02427, 0.144362, 5.62668, 10.6957, -4.82202, 5.87922, 2.72121, 10.6724, 9.7351, 16.2918, 9.43877, -9.27698, -8.71053, -9.82637, 9.75014, -17.1566, 5.93795, 1.75586, 9.00507, 4.52858, 2.52487, -4.0097, 4.15912, -2.05357, -12.6709, 0.276251, -13.1831, 19.1606, -7.30719, 8.82338, 3.18727, -19.3031, -3.53587, 5.18039, -2.1716, 2.26269, -18.1886, -4.23604, 2.20461, -3.64057, 6.14764, -20.4844, -2.48482, 1.85714, 2.83248, -1.63155, 1.18404, 4.69635, 11.6412, -0.49095, -3.34561, 18.32, 7.38042, 6.94133, 8.02371, 6.58309, -2.36223, 5.56471, -19.7254, 18.9698, 6.95512, -2.58096, 11.8546, -12.0443, -3.95695, 13.2732, -1.56812, -1.29381, -12.8721, -0.125778, 1.91169, 6.92839, -8.65606, -7.0797, -7.38147, 13.2883, -12.0632, 12.4999, 7.15478, 2.23228, 11.6576, -6.29195, 10.4249, 10.3944, -9.99512, -0.0278962, 16.5471, 13.1591, 10.595, -1.23791, 13.9528, -2.99213, -13.2838, -19.8328, -0.316844, -0.231031, -6.65275, 8.16559, -0.395187, -2.2347, 0.567379, -2.52104, 4.42737, 0.019386, 6.34154, -17.3032, -8.07562, -17.4881, 1.67987, -32.2397, -2.88786, 16.6696, 2.42339, -2.61061, 0.332972, -9.65453, -4.7152, 9.39784, -21.3683, -2.7891, -1.47142, 3.64088, -19.4054, -4.22799, 6.02261, 8.64935, -10.6361, 0.324926, 9.04967, -8.85765, -9.23384, -5.59507, -3.23616, -16.798, -6.36774, -11.5263, 6.35869, -3.11659, -16.2936, -16.1043, -4.95257, -13.1307, -3.01546, 1.56546, -13.0288, 15.5564, -8.48726, -5.51753, 1.34621, 3.50685, -2.60643, -6.6046, 1.21088, -2.21754, -9.33144, -5.89475, -3.75448, -2.87301, -0.785521, 6.64574, 5.95354, 9.3818, 0.136919, -5.86371, 2.70095, -18.8488, -1.44627, 2.56111, 28.7079, 7.35823, -7.99454, 17.9521, 13.0294, -5.91295, -1.7656, 1.61305, 9.34423, -17.9016, 10.5368, 9.10991, 0.407626, 26.7989, -3.74135, 5.0303, 15.6957, 0.267234, 18.4198, -5.73488, -2.39445, -9.7084, 10.6797, 1.23832, 23.5109, -2.6554, 4.64276, -5.31417, -5.14342, -6.64921, 10.0053, 3.99303, 0.257101, -1.19218, 14.9264, -7.23372, -3.69338, 4.10929, -6.23884, 11.8928, -6.62754, -1.29964, 3.78404, -16.2032, -9.05516, 18.5408, 17.9591, -1.31808, 15.3894, -1.96743, 12.1552, 10.1205, -2.35646, -2.964, 11.0719, -6.8081, 0.207617, -3.55323, -11.7092, 5.44046, -10.4181, -3.89491, 3.10656, 3.30114, -23.3613, -9.21074, -7.93881, -0.130789, 5.29897, -10.2003, -2.20318, 3.12199, 5.62244, 6.35004, -2.57322, -20.7089, -10.0574, 0.373423, 2.30288, -4.96459, 5.03268, 6.72165, -2.32482, -13.308, -0.00591522, -5.67469, -7.20664, 10.225, -4.01846, 15.2182, -3.89074, 3.82737, 10.2601, -3.04303, 16.095, 2.93864, -12.2585, -1.00981, -9.26042, -8.57367, 14.7721, 5.74331, 9.66847, -6.38309, -6.55133, -9.86003, -4.12024, -21.1392, 21.8521, -12.8212, -2.88583, 13.2002, -9.40251, -4.99795, 9.27229, 13.6098, 12.2145, 4.30175, -6.35023, 13.9882, -16.5936, -0.943788, 9.67642, -3.97249, -13.1865, -11.1041, 15.8192, 0.0841897, -12.9555, 1.86595, -7.44207, 15.0369, -5.34339, 8.29651, -1.48377, 6.85304, 3.88568, 10.6875, -3.71719, -10.1058, 5.21657, 0.91121, 8.08916, -6.27634, -1.84916, -8.41032, -4.81973, 2.09133, -1.65549, 14.473, 5.43135, 16.7953, 18.4495, 10.448, 10.2405, 2.05461, 1.69844, -28.1261, 12.0208, 0.456494, 16.8489, 3.33814, 12.1927, 3.71899, -5.32856, -6.45676, 6.68535, -7.04938, 2.49077, 6.09165, 15.8323, -2.29636, 8.39113, 10.455, -2.1317, 8.42727, -3.86663, 3.83541, -7.48336, 4.43802, -16.5646, 1.30327, 6.67074, -2.09986, -4.5706, -19.7646, -7.52276, -4.38797, -0.317302, -10.5347, -7.32772, 0.985516, 17.5833, 1.67793, 7.93042, 2.80985, 10.4229, 3.66888, -1.31417, 0.667819, 11.8864, -0.204737, -2.45872, -8.23323, 4.19035, -1.0725, -1.83337, 6.24622, 9.99697, 4.56134, 4.1057, 0.985324, -10.3802, 0.896837, -7.8647, 24.8408, 13.4912, -0.781501, -12.9632, -8.70686, 10.4755, -5.713, -5.71744, 13.3873, -11.3392, -0.261854, -1.46439, -1.801, 2.2396, 4.54412, 12.2183, 14.1771, -7.63861, -0.165078, -10.7337, -8.91264, 1.64392, 2.48099, 14.5376, 7.2159, 11.2742, 2.0162, -18.6678, -10.4734, 6.25276, 2.56863, 6.81633, -8.22421, -0.894961, -9.54764, -3.58953, -2.24902, 3.24052, 2.13827, -2.97264, 12.7571, -4.72481, 1.64881, 6.48525, 17.7058, -11.2629, 2.79035, -5.21706, -6.86172, 12.6638, -4.52133, 12.5149, 1.62079, 4.55371, 0.288851, -21.6445, 2.73154, -8.88006, -23.0672, -4.7953, 1.6765, 1.60166, 14.4732, 0.41955, -4.25002, 10.7512, -11.7658, -3.86514, 19.8116, 2.59178, 17.2492, 2.5176, -24.9206, -6.60869, 3.43874, 7.37036, -11.8929, -5.13794, 8.55787, 4.12453, -12.5432, -4.98376, -2.21745, 1.11497, -26.0134, -11.4617, 11.3238, 7.71555, -17.1011, -1.77521, -8.10137, -17.6965, 7.53612, -2.36685, -12.085, -1.15339))
plot(density(c(-5.66617, -4.04316, -8.37353, 2.36646, -18.0919, -16.8729, -4.82575, -10.3389, -1.98658, -5.73012, 8.86155, -19.5171, -12.0238, -9.6889, 13.117, 4.06623, -2.80454, -10.8397, 4.33737, -6.26259, -15.6942, -8.02427, 0.144362, 5.62668, 10.6957, -4.82202, 5.87922, 2.72121, 10.6724, 9.7351, 16.2918, 9.43877, -9.27698, -8.71053, -9.82637, 9.75014, -17.1566, 5.93795, 1.75586, 9.00507, 4.52858, 2.52487, -4.0097, 4.15912, -2.05357, -12.6709, 0.276251, -13.1831, 19.1606, -7.30719, 8.82338, 3.18727, -19.3031, -3.53587, 5.18039, -2.1716, 2.26269, -18.1886, -4.23604, 2.20461, -3.64057, 6.14764, -20.4844, -2.48482, 1.85714, 2.83248, -1.63155, 1.18404, 4.69635, 11.6412, -0.49095, -3.34561, 18.32, 7.38042, 6.94133, 8.02371, 6.58309, -2.36223, 5.56471, -19.7254, 18.9698, 6.95512, -2.58096, 11.8546, -12.0443, -3.95695, 13.2732, -1.56812, -1.29381, -12.8721, -0.125778, 1.91169, 6.92839, -8.65606, -7.0797, -7.38147, 13.2883, -12.0632, 12.4999, 7.15478, 2.23228, 11.6576, -6.29195, 10.4249, 10.3944, -9.99512, -0.0278962, 16.5471, 13.1591, 10.595, -1.23791, 13.9528, -2.99213, -13.2838, -19.8328, -0.316844, -0.231031, -6.65275, 8.16559, -0.395187, -2.2347, 0.567379, -2.52104, 4.42737, 0.019386, 6.34154, -17.3032, -8.07562, -17.4881, 1.67987, -32.2397, -2.88786, 16.6696, 2.42339, -2.61061, 0.332972, -9.65453, -4.7152, 9.39784, -21.3683, -2.7891, -1.47142, 3.64088, -19.4054, -4.22799, 6.02261, 8.64935, -10.6361, 0.324926, 9.04967, -8.85765, -9.23384, -5.59507, -3.23616, -16.798, -6.36774, -11.5263, 6.35869, -3.11659, -16.2936, -16.1043, -4.95257, -13.1307, -3.01546, 1.56546, -13.0288, 15.5564, -8.48726, -5.51753, 1.34621, 3.50685, -2.60643, -6.6046, 1.21088, -2.21754, -9.33144, -5.89475, -3.75448, -2.87301, -0.785521, 6.64574, 5.95354, 9.3818, 0.136919, -5.86371, 2.70095, -18.8488, -1.44627, 2.56111, 28.7079, 7.35823, -7.99454, 17.9521, 13.0294, -5.91295, -1.7656, 1.61305, 9.34423, -17.9016, 10.5368, 9.10991, 0.407626, 26.7989, -3.74135, 5.0303, 15.6957, 0.267234, 18.4198, -5.73488, -2.39445, -9.7084, 10.6797, 1.23832, 23.5109, -2.6554, 4.64276, -5.31417, -5.14342, -6.64921, 10.0053, 3.99303, 0.257101, -1.19218, 14.9264, -7.23372, -3.69338, 4.10929, -6.23884, 11.8928, -6.62754, -1.29964, 3.78404, -16.2032, -9.05516, 18.5408, 17.9591, -1.31808, 15.3894, -1.96743, 12.1552, 10.1205, -2.35646, -2.964, 11.0719, -6.8081, 0.207617, -3.55323, -11.7092, 5.44046, -10.4181, -3.89491, 3.10656, 3.30114, -23.3613, -9.21074, -7.93881, -0.130789, 5.29897, -10.2003, -2.20318, 3.12199, 5.62244, 6.35004, -2.57322, -20.7089, -10.0574, 0.373423, 2.30288, -4.96459, 5.03268, 6.72165, -2.32482, -13.308, -0.00591522, -5.67469, -7.20664, 10.225, -4.01846, 15.2182, -3.89074, 3.82737, 10.2601, -3.04303, 16.095, 2.93864, -12.2585, -1.00981, -9.26042, -8.57367, 14.7721, 5.74331, 9.66847, -6.38309, -6.55133, -9.86003, -4.12024, -21.1392, 21.8521, -12.8212, -2.88583, 13.2002, -9.40251, -4.99795, 9.27229, 13.6098, 12.2145, 4.30175, -6.35023, 13.9882, -16.5936, -0.943788, 9.67642, -3.97249, -13.1865, -11.1041, 15.8192, 0.0841897, -12.9555, 1.86595, -7.44207, 15.0369, -5.34339, 8.29651, -1.48377, 6.85304, 3.88568, 10.6875, -3.71719, -10.1058, 5.21657, 0.91121, 8.08916, -6.27634, -1.84916, -8.41032, -4.81973, 2.09133, -1.65549, 14.473, 5.43135, 16.7953, 18.4495, 10.448, 10.2405, 2.05461, 1.69844, -28.1261, 12.0208, 0.456494, 16.8489, 3.33814, 12.1927, 3.71899, -5.32856, -6.45676, 6.68535, -7.04938, 2.49077, 6.09165, 15.8323, -2.29636, 8.39113, 10.455, -2.1317, 8.42727, -3.86663, 3.83541, -7.48336, 4.43802, -16.5646, 1.30327, 6.67074, -2.09986, -4.5706, -19.7646, -7.52276, -4.38797, -0.317302, -10.5347, -7.32772, 0.985516, 17.5833, 1.67793, 7.93042, 2.80985, 10.4229, 3.66888, -1.31417, 0.667819, 11.8864, -0.204737, -2.45872, -8.23323, 4.19035, -1.0725, -1.83337, 6.24622, 9.99697, 4.56134, 4.1057, 0.985324, -10.3802, 0.896837, -7.8647, 24.8408, 13.4912, -0.781501, -12.9632, -8.70686, 10.4755, -5.713, -5.71744, 13.3873, -11.3392, -0.261854, -1.46439, -1.801, 2.2396, 4.54412, 12.2183, 14.1771, -7.63861, -0.165078, -10.7337, -8.91264, 1.64392, 2.48099, 14.5376, 7.2159, 11.2742, 2.0162, -18.6678, -10.4734, 6.25276, 2.56863, 6.81633, -8.22421, -0.894961, -9.54764, -3.58953, -2.24902, 3.24052, 2.13827, -2.97264, 12.7571, -4.72481, 1.64881, 6.48525, 17.7058, -11.2629, 2.79035, -5.21706, -6.86172, 12.6638, -4.52133, 12.5149, 1.62079, 4.55371, 0.288851, -21.6445, 2.73154, -8.88006, -23.0672, -4.7953, 1.6765, 1.60166, 14.4732, 0.41955, -4.25002, 10.7512, -11.7658, -3.86514, 19.8116, 2.59178, 17.2492, 2.5176, -24.9206, -6.60869, 3.43874, 7.37036, -11.8929, -5.13794, 8.55787, 4.12453, -12.5432, -4.98376, -2.21745, 1.11497, -26.0134, -11.4617, 11.3238, 7.71555, -17.1011, -1.77521, -8.10137, -17.6965, 7.53612, -2.36685, -12.085, -1.15339))
)
y <-  c(-5.66617, -4.04316, -8.37353, 2.36646, -18.0919, -16.8729, -4.82575, -10.3389, -1.98658, -5.73012, 8.86155, -19.5171, -12.0238, -9.6889, 13.117, 4.06623, -2.80454, -10.8397, 4.33737, -6.26259, -15.6942, -8.02427, 0.144362, 5.62668, 10.6957, -4.82202, 5.87922, 2.72121, 10.6724, 9.7351, 16.2918, 9.43877, -9.27698, -8.71053, -9.82637, 9.75014, -17.1566, 5.93795, 1.75586, 9.00507, 4.52858, 2.52487, -4.0097, 4.15912, -2.05357, -12.6709, 0.276251, -13.1831, 19.1606, -7.30719, 8.82338, 3.18727, -19.3031, -3.53587, 5.18039, -2.1716, 2.26269, -18.1886, -4.23604, 2.20461, -3.64057, 6.14764, -20.4844, -2.48482, 1.85714, 2.83248, -1.63155, 1.18404, 4.69635, 11.6412, -0.49095, -3.34561, 18.32, 7.38042, 6.94133, 8.02371, 6.58309, -2.36223, 5.56471, -19.7254, 18.9698, 6.95512, -2.58096, 11.8546, -12.0443, -3.95695, 13.2732, -1.56812, -1.29381, -12.8721, -0.125778, 1.91169, 6.92839, -8.65606, -7.0797, -7.38147, 13.2883, -12.0632, 12.4999, 7.15478, 2.23228, 11.6576, -6.29195, 10.4249, 10.3944, -9.99512, -0.0278962, 16.5471, 13.1591, 10.595, -1.23791, 13.9528, -2.99213, -13.2838, -19.8328, -0.316844, -0.231031, -6.65275, 8.16559, -0.395187, -2.2347, 0.567379, -2.52104, 4.42737, 0.019386, 6.34154, -17.3032, -8.07562, -17.4881, 1.67987, -32.2397, -2.88786, 16.6696, 2.42339, -2.61061, 0.332972, -9.65453, -4.7152, 9.39784, -21.3683, -2.7891, -1.47142, 3.64088, -19.4054, -4.22799, 6.02261, 8.64935, -10.6361, 0.324926, 9.04967, -8.85765, -9.23384, -5.59507, -3.23616, -16.798, -6.36774, -11.5263, 6.35869, -3.11659, -16.2936, -16.1043, -4.95257, -13.1307, -3.01546, 1.56546, -13.0288, 15.5564, -8.48726, -5.51753, 1.34621, 3.50685, -2.60643, -6.6046, 1.21088, -2.21754, -9.33144, -5.89475, -3.75448, -2.87301, -0.785521, 6.64574, 5.95354, 9.3818, 0.136919, -5.86371, 2.70095, -18.8488, -1.44627, 2.56111, 28.7079, 7.35823, -7.99454, 17.9521, 13.0294, -5.91295, -1.7656, 1.61305, 9.34423, -17.9016, 10.5368, 9.10991, 0.407626, 26.7989, -3.74135, 5.0303, 15.6957, 0.267234, 18.4198, -5.73488, -2.39445, -9.7084, 10.6797, 1.23832, 23.5109, -2.6554, 4.64276, -5.31417, -5.14342, -6.64921, 10.0053, 3.99303, 0.257101, -1.19218, 14.9264, -7.23372, -3.69338, 4.10929, -6.23884, 11.8928, -6.62754, -1.29964, 3.78404, -16.2032, -9.05516, 18.5408, 17.9591, -1.31808, 15.3894, -1.96743, 12.1552, 10.1205, -2.35646, -2.964, 11.0719, -6.8081, 0.207617, -3.55323, -11.7092, 5.44046, -10.4181, -3.89491, 3.10656, 3.30114, -23.3613, -9.21074, -7.93881, -0.130789, 5.29897, -10.2003, -2.20318, 3.12199, 5.62244, 6.35004, -2.57322, -20.7089, -10.0574, 0.373423, 2.30288, -4.96459, 5.03268, 6.72165, -2.32482, -13.308, -0.00591522, -5.67469, -7.20664, 10.225, -4.01846, 15.2182, -3.89074, 3.82737, 10.2601, -3.04303, 16.095, 2.93864, -12.2585, -1.00981, -9.26042, -8.57367, 14.7721, 5.74331, 9.66847, -6.38309, -6.55133, -9.86003, -4.12024, -21.1392, 21.8521, -12.8212, -2.88583, 13.2002, -9.40251, -4.99795, 9.27229, 13.6098, 12.2145, 4.30175, -6.35023, 13.9882, -16.5936, -0.943788, 9.67642, -3.97249, -13.1865, -11.1041, 15.8192, 0.0841897, -12.9555, 1.86595, -7.44207, 15.0369, -5.34339, 8.29651, -1.48377, 6.85304, 3.88568, 10.6875, -3.71719, -10.1058, 5.21657, 0.91121, 8.08916, -6.27634, -1.84916, -8.41032, -4.81973, 2.09133, -1.65549, 14.473, 5.43135, 16.7953, 18.4495, 10.448, 10.2405, 2.05461, 1.69844, -28.1261, 12.0208, 0.456494, 16.8489, 3.33814, 12.1927, 3.71899, -5.32856, -6.45676, 6.68535, -7.04938, 2.49077, 6.09165, 15.8323, -2.29636, 8.39113, 10.455, -2.1317, 8.42727, -3.86663, 3.83541, -7.48336, 4.43802, -16.5646, 1.30327, 6.67074, -2.09986, -4.5706, -19.7646, -7.52276, -4.38797, -0.317302, -10.5347, -7.32772, 0.985516, 17.5833, 1.67793, 7.93042, 2.80985, 10.4229, 3.66888, -1.31417, 0.667819, 11.8864, -0.204737, -2.45872, -8.23323, 4.19035, -1.0725, -1.83337, 6.24622, 9.99697, 4.56134, 4.1057, 0.985324, -10.3802, 0.896837, -7.8647, 24.8408, 13.4912, -0.781501, -12.9632, -8.70686, 10.4755, -5.713, -5.71744, 13.3873, -11.3392, -0.261854, -1.46439, -1.801, 2.2396, 4.54412, 12.2183, 14.1771, -7.63861, -0.165078, -10.7337, -8.91264, 1.64392, 2.48099, 14.5376, 7.2159, 11.2742, 2.0162, -18.6678, -10.4734, 6.25276, 2.56863, 6.81633, -8.22421, -0.894961, -9.54764, -3.58953, -2.24902, 3.24052, 2.13827, -2.97264, 12.7571, -4.72481, 1.64881, 6.48525, 17.7058, -11.2629, 2.79035, -5.21706, -6.86172, 12.6638, -4.52133, 12.5149, 1.62079, 4.55371, 0.288851, -21.6445, 2.73154, -8.88006, -23.0672, -4.7953, 1.6765, 1.60166, 14.4732, 0.41955, -4.25002, 10.7512, -11.7658, -3.86514, 19.8116, 2.59178, 17.2492, 2.5176, -24.9206, -6.60869, 3.43874, 7.37036, -11.8929, -5.13794, 8.55787, 4.12453, -12.5432, -4.98376, -2.21745, 1.11497, -26.0134, -11.4617, 11.3238, 7.71555, -17.1011, -1.77521, -8.10137, -17.6965, 7.53612, -2.36685, -12.085, -1.15339)
c(-5.66617, -4.04316, -8.37353, 2.36646, -18.0919, -16.8729, -4.82575, -10.3389, -1.98658, -5.73012, 8.86155, -19.5171, -12.0238, -9.6889, 13.117, 4.06623, -2.80454, -10.8397, 4.33737, -6.26259, -15.6942, -8.02427, 0.144362, 5.62668, 10.6957, -4.82202, 5.87922, 2.72121, 10.6724, 9.7351, 16.2918, 9.43877, -9.27698, -8.71053, -9.82637, 9.75014, -17.1566, 5.93795, 1.75586, 9.00507, 4.52858, 2.52487, -4.0097, 4.15912, -2.05357, -12.6709, 0.276251, -13.1831, 19.1606, -7.30719, 8.82338, 3.18727, -19.3031, -3.53587, 5.18039, -2.1716, 2.26269, -18.1886, -4.23604, 2.20461, -3.64057, 6.14764, -20.4844, -2.48482, 1.85714, 2.83248, -1.63155, 1.18404, 4.69635, 11.6412, -0.49095, -3.34561, 18.32, 7.38042, 6.94133, 8.02371, 6.58309, -2.36223, 5.56471, -19.7254, 18.9698, 6.95512, -2.58096, 11.8546, -12.0443, -3.95695, 13.2732, -1.56812, -1.29381, -12.8721, -0.125778, 1.91169, 6.92839, -8.65606, -7.0797, -7.38147, 13.2883, -12.0632, 12.4999, 7.15478, 2.23228, 11.6576, -6.29195, 10.4249, 10.3944, -9.99512, -0.0278962, 16.5471, 13.1591, 10.595, -1.23791, 13.9528, -2.99213, -13.2838, -19.8328, -0.316844, -0.231031, -6.65275, 8.16559, -0.395187, -2.2347, 0.567379, -2.52104, 4.42737, 0.019386, 6.34154, -17.3032, -8.07562, -17.4881, 1.67987, -32.2397, -2.88786, 16.6696, 2.42339, -2.61061, 0.332972, -9.65453, -4.7152, 9.39784, -21.3683, -2.7891, -1.47142, 3.64088, -19.4054, -4.22799, 6.02261, 8.64935, -10.6361, 0.324926, 9.04967, -8.85765, -9.23384, -5.59507, -3.23616, -16.798, -6.36774, -11.5263, 6.35869, -3.11659, -16.2936, -16.1043, -4.95257, -13.1307, -3.01546, 1.56546, -13.0288, 15.5564, -8.48726, -5.51753, 1.34621, 3.50685, -2.60643, -6.6046, 1.21088, -2.21754, -9.33144, -5.89475, -3.75448, -2.87301, -0.785521, 6.64574, 5.95354, 9.3818, 0.136919, -5.86371, 2.70095, -18.8488, -1.44627, 2.56111, 28.7079, 7.35823, -7.99454, 17.9521, 13.0294, -5.91295, -1.7656, 1.61305, 9.34423, -17.9016, 10.5368, 9.10991, 0.407626, 26.7989, -3.74135, 5.0303, 15.6957, 0.267234, 18.4198, -5.73488, -2.39445, -9.7084, 10.6797, 1.23832, 23.5109, -2.6554, 4.64276, -5.31417, -5.14342, -6.64921, 10.0053, 3.99303, 0.257101, -1.19218, 14.9264, -7.23372, -3.69338, 4.10929, -6.23884, 11.8928, -6.62754, -1.29964, 3.78404, -16.2032, -9.05516, 18.5408, 17.9591, -1.31808, 15.3894, -1.96743, 12.1552, 10.1205, -2.35646, -2.964, 11.0719, -6.8081, 0.207617, -3.55323, -11.7092, 5.44046, -10.4181, -3.89491, 3.10656, 3.30114, -23.3613, -9.21074, -7.93881, -0.130789, 5.29897, -10.2003, -2.20318, 3.12199, 5.62244, 6.35004, -2.57322, -20.7089, -10.0574, 0.373423, 2.30288, -4.96459, 5.03268, 6.72165, -2.32482, -13.308, -0.00591522, -5.67469, -7.20664, 10.225, -4.01846, 15.2182, -3.89074, 3.82737, 10.2601, -3.04303, 16.095, 2.93864, -12.2585, -1.00981, -9.26042, -8.57367, 14.7721, 5.74331, 9.66847, -6.38309, -6.55133, -9.86003, -4.12024, -21.1392, 21.8521, -12.8212, -2.88583, 13.2002, -9.40251, -4.99795, 9.27229, 13.6098, 12.2145, 4.30175, -6.35023, 13.9882, -16.5936, -0.943788, 9.67642, -3.97249, -13.1865, -11.1041, 15.8192, 0.0841897, -12.9555, 1.86595, -7.44207, 15.0369, -5.34339, 8.29651, -1.48377, 6.85304, 3.88568, 10.6875, -3.71719, -10.1058, 5.21657, 0.91121, 8.08916, -6.27634, -1.84916, -8.41032, -4.81973, 2.09133, -1.65549, 14.473, 5.43135, 16.7953, 18.4495, 10.448, 10.2405, 2.05461, 1.69844, -28.1261, 12.0208, 0.456494, 16.8489, 3.33814, 12.1927, 3.71899, -5.32856, -6.45676, 6.68535, -7.04938, 2.49077, 6.09165, 15.8323, -2.29636, 8.39113, 10.455, -2.1317, 8.42727, -3.86663, 3.83541, -7.48336, 4.43802, -16.5646, 1.30327, 6.67074, -2.09986, -4.5706, -19.7646, -7.52276, -4.38797, -0.317302, -10.5347, -7.32772, 0.985516, 17.5833, 1.67793, 7.93042, 2.80985, 10.4229, 3.66888, -1.31417, 0.667819, 11.8864, -0.204737, -2.45872, -8.23323, 4.19035, -1.0725, -1.83337, 6.24622, 9.99697, 4.56134, 4.1057, 0.985324, -10.3802, 0.896837, -7.8647, 24.8408, 13.4912, -0.781501, -12.9632, -8.70686, 10.4755, -5.713, -5.71744, 13.3873, -11.3392, -0.261854, -1.46439, -1.801, 2.2396, 4.54412, 12.2183, 14.1771, -7.63861, -0.165078, -10.7337, -8.91264, 1.64392, 2.48099, 14.5376, 7.2159, 11.2742, 2.0162, -18.6678, -10.4734, 6.25276, 2.56863, 6.81633, -8.22421, -0.894961, -9.54764, -3.58953, -2.24902, 3.24052, 2.13827, -2.97264, 12.7571, -4.72481, 1.64881, 6.48525, 17.7058, -11.2629, 2.79035, -5.21706, -6.86172, 12.6638, -4.52133, 12.5149, 1.62079, 4.55371, 0.288851, -21.6445, 2.73154, -8.88006, -23.0672, -4.7953, 1.6765, 1.60166, 14.4732, 0.41955, -4.25002, 10.7512, -11.7658, -3.86514, 19.8116, 2.59178, 17.2492, 2.5176, -24.9206, -6.60869, 3.43874, 7.37036, -11.8929, -5.13794, 8.55787, 4.12453, -12.5432, -4.98376, -2.21745, 1.11497, -26.0134, -11.4617, 11.3238, 7.71555, -17.1011, -1.77521, -8.10137, -17.6965, 7.53612, -2.36685, -12.085, -1.15339)
x <- c(1,2)
plot(x)
x <- 0:1:.01
x <- 0:.01:1
x <- -5:.01:5
x <- -5:.01:5
x <- -5:.01:5
x <- sseq(-5,5,by = .01)
x <- seq(-5,5,by = .01)
y <- 0.25 + dnorm(x,0,5)
plot(x,y)
x <- seq(-40,40,by = .01)
y <- 0.25 + dnorm(x,0,5)
plot(x,y)
plot(x,y, ylims = c(0,.40), type = 'l')
plot(x,y, ylim = c(0,.40), type = 'l')
max(y)/min(y)
x <- seq(-10,10,by = .01)
y <- 0.25 + dnorm(x,0,5)
plot(x,y, ylim = c(0,.40), type = 'l')
max(y)/min(y)
x <- seq(-20,20,by = .01)
y <- 0.25 + dnorm(x,0,5)
plot(x,y, ylim = c(0,.40), type = 'l')
max(y)/min(y)
x <- seq(-30,30,by = .01)
y <- 0.25 + dnorm(x,0,5)
plot(x,y, ylim = c(0,.40), type = 'l')
max(y)/min(y)
plot(x,y, type = 'l')
ylim = c(0,.40),
y <- 0.25 + dnorm(x,0,5)
plot(x,y, ylim = c(0,.40), type = 'l')
max(y)/min(y)
y <- y / mean(y)
plot(x,y, ylim = c(0,.40), type = 'l')
plot(x,y,  type = 'l')
max(y)/min(y)
par()
phenotype <- seq(-30,30,by = .01)
y <- 0.25 + dnorm(x,0,5)
y <- y / mean(y)
plot(x,y,  type = 'l')
max(y)/min(y)
par(resetpar())
par(resetPar())
dev.off()
phenotype <- seq(-30,30,by = .01)
y <- 0.25 + dnorm(x,0,5)
y <- y / mean(y)
plot(x,y,  type = 'l')
max(y)/min(y)
dev.off()
phenotype <- seq(-30,30,by = .01)
y <- 0.25 + dnorm(x,0,5)
y <- 4 * y
plot(x,y,  type = 'l')
max(y)/min(y)
dev.off()
phenotype <- seq(-30,30,by = .01)
y <- 0.25 + dnorm(x,0,5)
y <- 4 * y
plot(x,y,  type = 'l')
max(y)/min(y)
plot(x,y,  type = 'l', xlab = 'phenotype', ylab = 'Relative Fitness')
load("~/Documents/GitHub/EpistasisSim/DirectionalEpistasis.RData")
ABC_SLiM$stats
ABC_SLiM$param
plot(density(ABC_SLiM$param[,1]))
plot(density(ABC_SLiM$param[,2]))
plot(density(ABC_SLiM$param[,3]))
abline(v=mean(ABC_SLiM$param[,3]))
max(ABC_SLiM$stats)
which(ABC_SLiM$stats == max(ABC_SLiM$stats))
ABC_SLiM$stats[26,]
ABC_SLiM$stats[24:28,]
for(j in 1:9){
for(k in (j+1):10){
jaccmat[j,k] <- length(intersect(signsnps[[j]], signsnps[[k]])) / length(union(signsnps[[j]], signsnps[[k]]))
}
}
ABC_SLiM$stats
7200/3
png(filename = "EmpericalBoth.png", width = 7200, height = 2400)
ggplot(data, aes(y=Jaccards, x=as.factor(treatment))) +
geom_boxplot(aes(fill=as.factor(generation)), stat="boxplot", position="dodge", alpha=0.5, width=0.2) +
theme_grey() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="generation")) +
ggtitle("Empirical Selection Coefficients and Starting Frequencies") +
xlab("Fitness Function") +
ylab("Jaccard Score") +
ylim(0,1)
########################
## Internal Functions ##
########################
GetJaccards <- function(rawout, cutoff, results){
for(gen in 1:2){
signsnps <- vector("list",10)
names(signsnps) <- paste('pop', 1:10)
for(pop in 1:10){
popdat <- rawout[which(rawout[,2] == pop),]
if(gen == 1){
signsnps[[pop]] <- which((popdat[2,3:ncol(popdat)] - popdat[1,3:ncol(popdat)]) >= cutoff)
}else if(gen == 2){
signsnps[[pop]] <- which((popdat[3,3:ncol(popdat)] - popdat[1,3:ncol(popdat)]) >= cutoff)
}
}
jaccmat <- array(dim = c(10,10))
for(j in 1:9){
for(k in (j+1):10){
jaccmat[j,k] <- length(intersect(signsnps[[j]], signsnps[[k]])) / length(union(signsnps[[j]], signsnps[[k]]))
if(length(union(signsnps[[j]], signsnps[[k]])) == 0) jaccmat[j,k] <- 0
cat("Intersect: ", length(intersect(signsnps[[j]], signsnps[[k]])))
cat("    Union: ", length(union(signsnps[[j]], signsnps[[k]])), "\n")
}
}
jaccmat <- na.omit(as.vector(jaccmat))
# results[(5 * i + 1):(5 *  i + 5)] <- quantile(jaccmat)
results[[gen]] <- c(results[[gen]], jaccmat)
}
return(results)
}
################
## Parameters ##
################
library(ggraptR)
setwd("~/Documents/GitHub/EpistasisSim")
haplotypedata <- readRDS(file = 'hap_blocks.RDS')
hap_blocks.jaccard.sim10.RDS <- readRDS(file = 'hap_blocks.jaccard.sim10.gen10_cutoff.RDS')
iter <- 1
seeds <- sample(1:2^15, 5 * iter)
npops = 10
nloci = 121
RR = 0.5
popsize = 1750
fmin = 0
fmax = 1
ahat <- 3
bhat <- 0
########################
## Positive Epistasis ##
########################
ExpJaccards <- list("Gen6" = c(),
"Gen10" = c())
for(i in 1:iter){
system(paste("slim -d seed=", seeds[i],
" -d npops=", npops,
" -d nloci=", nloci,
" -d RR=",RR,
" -d popsize=", popsize,
" -d " ,'"', 'fitnessFunction=', "'", 'exponential', "'", '"',
" -d fmin=", fmin,
" -d fmax=", fmax,
" -d a=", ahat,
" New.slim | tail -n +14 > output/exponential",
"_seed=", seeds[i],
"_a=", ahat,
"_b=", bhat, ".csv", sep = ""))
rawout <- as.matrix(read.csv(file = paste('./output/exponential',
"_seed=", seeds[i],
"_a=", ahat,
"_b=", bhat, ".csv", sep = "")))
rawout <- rawout[,-ncol(rawout)]
ExpJaccards <- GetJaccards(rawout = rawout,
cutoff = haplotypedata$Gen10_AFC10,
results = ExpJaccards)
system(paste("rm ./output/exponential",
"_seed=", seeds[i],
"_a=", ahat,
"_b=", bhat, ".csv", sep = ''))
}
########################
## Negative Epistasis ##
########################
ahat <- -ahat
NegJaccards <- list("Gen6" = c(),
"Gen10" = c())
for(i in 1:iter){
system(paste("slim -d seed=", seeds[i],
" -d npops=", npops,
" -d nloci=", nloci,
" -d RR=",RR,
" -d popsize=", popsize,
" -d " ,'"', 'fitnessFunction=', "'", 'exponential', "'", '"',
" -d fmin=", fmin,
" -d fmax=", fmax,
" -d a=", ahat,
" -d b=", bhat,
" New.slim | tail -n +14 > output/exponential",
"_seed=", seeds[i],
"_a=", ahat,
"_b=", bhat, ".csv", sep = ""))
rawout <- as.matrix(read.csv(file = paste('./output/exponential',
"_seed=", seeds[i],
"_a=", ahat,
"_b=", bhat, ".csv", sep = "")))
rawout <- rawout[,-ncol(rawout)]
NegJaccards <- GetJaccards(rawout = rawout,
cutoff = haplotypedata$Gen10_AFC10,
results = NegJaccards)
system(paste("rm ./output/exponential",
"_seed=", seeds[i],
"_a=", ahat,
"_b=", bhat, ".csv", sep = ''))
}
#############################
## Multiplicative Fitness  ##
#############################
SSJaccards <- list("Gen6" = c(),
"Gen10" = c())
for(i in 1:iter){
system(paste("slim -d seed=", seeds[3 * iter + i],
" -d npops=", npops,
" -d nloci=", nloci,
" -d RR=",RR,
" -d popsize=", popsize,
" sim.slim | tail -n +14 > output/polygenic.csv", sep = ""))
rawout <- as.matrix(read.csv(file = paste('./output/polygenic.csv', sep = "")))
rawout <- rawout[,-ncol(rawout)]
SSJaccards <- GetJaccards(rawout = rawout,
cutoff = haplotypedata$Gen10_AFC10,
results = SSJaccards)
system("rm ./output/polygenic.csv")
}
###########################
## Directional Epistasis ##
###########################
# load("~/Documents/GitHub/EpistasisSim/DirectionalEpistasis.RData")
#
# shat <- sum(ABC_SLiM$weights * ABC_SLiM$param[,1])
# rhat <- sum(ABC_SLiM$weights * ABC_SLiM$param[,2])
# bhat <- sum(ABC_SLiM$weights * ABC_SLiM$param[,3]) * 100
shat <- 0.1
rhat <- -15
bhat <- -0.3
DirectionalJaccards <- list("Gen6" = c(),
"Gen10" = c())
for(i in 1:iter){
system(paste("slim -d seed=", seeds[i],
" -d npops=", npops,
" -d nloci=", nloci,
" -d RR=",RR,
" -d popsize=", popsize,
" -d " ,'"', 'fitnessFunction=', "'", 'directional', "'", '"',
" -d fmin=", fmin,
" -d fmax=", fmax,
" -d s=", shat,
" -d r=", rhat,
" -d b=", bhat,
" New.slim | tail -n +14 > output/directional",
"_seed=", seeds[i],
"_s=", shat,
"_r=", rhat,
"_b=", bhat, ".csv", sep = ""))
rawout <- as.matrix(read.csv(file = paste('./output/directional',
"_seed=", seeds[i],
"_s=", shat,
"_r=", rhat,
"_b=", bhat, ".csv", sep = "")))
rawout <- rawout[,-ncol(rawout)]
DirectionalJaccards <- GetJaccards(rawout = rawout,
cutoff = haplotypedata$Gen10_AFC10,
results = DirectionalJaccards)
system(paste("rm ./output/directional",
"_seed=", seeds[i],
"_s=", shat,
"_r=", rhat,
"_b=", bhat, ".csv", sep = ''))
}
###################################
## Diminishing Returns Epistasis ##
###################################
ahat <- 10
bhat <- -0.25
DimRetJaccards <- list("Gen6" = c(),
"Gen10" = c())
for(i in 1:iter){
system(paste("slim -d seed=", seeds[2 * iter + i],
" -d npops=", npops,
" -d nloci=", nloci,
" -d RR=",RR,
" -d popsize=", popsize,
" -d " ,'"', 'fitnessFunction=', "'", 'diminishingReturns', "'", '"',
" -d fmin=", fmin,
" -d fmax=", fmax,
" -d b=", bhat,
" -d a=", ahat,
" New.slim | tail -n +14 > output/diminishingReturns",
"_seed=", seeds[2 * iter + i],
"_a=", ahat,
"_b=", bhat, ".csv", sep = ""))
rawout <- as.matrix(read.csv(file = paste('./output/diminishingReturns',
"_seed=", seeds[2 * iter + i],
"_a=", ahat,
"_b=", bhat, ".csv", sep = "")))
rawout <- rawout[,-ncol(rawout)]
DimRetJaccards <- GetJaccards(rawout = rawout,
cutoff = haplotypedata$Gen10_AFC10,
results = DimRetJaccards)
system(paste("rm ./output/diminishingReturns",
"_seed=", seeds[2 * iter + i],
"_a=", ahat,
"_b=", bhat, ".csv", sep = ''))
}
###########################
## Stabilizing Epistasis ##
###########################
mu <- 0.4
std <- 0.07
StabJaccards <- list("Gen6" = c(),
"Gen10" = c())
for(i in 1:iter){
system(paste("slim -d seed=", seeds[2 * iter + i],
" -d npops=", npops,
" -d nloci=", nloci,
" -d RR=",RR,
" -d popsize=", popsize,
" -d " ,'"', 'fitnessFunction=', "'", 'stabilizing', "'", '"',
" -d mu=", mu,
" -d std=", std,
" New.slim | tail -n +14 > output/stabilizing",
"_seed=", seeds[2 * iter + i],
"_mu=", mu,
"_std=", std, ".csv", sep = ""))
rawout <- as.matrix(read.csv(file = paste('./output/stabilizing',
"_seed=", seeds[2 * iter + i],
"_mu=", mu,
"_std=", std, ".csv", sep = "")))
rawout <- rawout[,-ncol(rawout)]
StabJaccards <- GetJaccards(rawout = rawout,
cutoff = haplotypedata$Gen10_AFC10,
results = StabJaccards)
system(paste("rm ./output/stabilizing",
"_seed=", seeds[2 * iter + i],
"_mu=", mu,
"_std=", std, ".csv", sep = ''))
}
################################################
treatment <- c(rep("A Empirical", times = 73),
rep("B Multitplicative", times = 90),
rep("C Positive Epistasis", times = 90),
rep("D Negative Epistasis", times = 90),
rep("E Directional Epistasis", times = 90),
rep("F Truncating Epistasis", times = 90),
rep("G Stabilizing Epistasis", times = 90))
generation <- c(rep(6, each = 45), rep(10, times = 28),
rep(c(6,10), times = 6, each = 45))
Jaccards <- c(hap_blocks.jaccard.sim10.RDS[[1]],
hap_blocks.jaccard.sim10.RDS[[2]],
SSJaccards$Gen6,
SSJaccards$Gen10,
ExpJaccards$Gen6,
ExpJaccards$Gen10,
NegJaccards$Gen6,
NegJaccards$Gen10,
DirectionalJaccards$Gen6,
DirectionalJaccards$Gen10,
DimRetJaccards$Gen6,
DimRetJaccards$Gen10,
StabJaccards$Gen6,
StabJaccards$Gen10)
data <- data.frame(treatment, generation, Jaccards)
png(filename = "EmpericalBoth.png", width = 7200, height = 2400)
ggplot(data, aes(y=Jaccards, x=as.factor(treatment))) +
geom_boxplot(aes(fill=as.factor(generation)), stat="boxplot", position="dodge", alpha=0.5, width=0.2) +
theme_grey() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="generation")) +
ggtitle("Empirical Selection Coefficients and Starting Frequencies") +
xlab("Fitness Function") +
ylab("Jaccard Score") +
ylim(0,1)
dev.off()
png(filename = "EmpericalBoth.png", width = 3600, height = 2400)
ggplot(data, aes(y=Jaccards, x=as.factor(treatment))) +
geom_boxplot(aes(fill=as.factor(generation)), stat="boxplot", position="dodge", alpha=0.5, width=0.2) +
theme_grey() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="generation")) +
ggtitle("Empirical Selection Coefficients and Starting Frequencies") +
xlab("Fitness Function") +
ylab("Jaccard Score") +
ylim(0,1)
dev.off()
png(filename = "EmpericalBoth.png", width = 1800, height = 1000)
ggplot(data, aes(y=Jaccards, x=as.factor(treatment))) +
geom_boxplot(aes(fill=as.factor(generation)), stat="boxplot", position="dodge", alpha=0.5, width=0.2) +
theme_grey() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
guides(fill=guide_legend(title="generation")) +
ggtitle("Empirical Selection Coefficients and Starting Frequencies") +
xlab("Fitness Function") +
ylab("Jaccard Score") +
ylim(0,1)
dev.off()
summary(haplotypedata$selCoef)
plot(x = x, y = multiplicative)
####################
## Multiplicative ##
####################
nmuts <- 1:121
x <- nmuts / 121
multiplicative <- 1.13^nmuts
plot(x = x, y = multiplicative)
####################
## Multiplicative ##
####################
nmuts <- 1:121
x <- nmuts / 121
multiplicative <- 1.13^nmuts
plot(x = x, y = multiplicative, tpye = 'l')
plot(x = x, y = multiplicative, type = 'l')
